 <template name="anagraphicArtworkWizardContainer">
  <div id="anagraphicArtwork" class="page">
    <div class="content">

      <div class="col col-xs-8 col-xs-offset-2">
        <div class="panel panel-info">
          <div class="panel-heading">
            Artwork's anagraphic
          </div>
          <div class="panel-body">
            {{> anagraphicArtworkWizard}}
          </div>
        </div>
      </div>

    </div>
  </div>
</template>

<template name="anagraphicArtworkWizard">
  <div id="anagraphicArtworkWizard">
    <div class="col-xs-12">
      <ul class="nav nav-pills nav-stacked col-xs-3">
        <li class="{{isTabActive 'anagraphicTab'}}"><a class="tab-selector" data-selection="anagraphicTab" data-toggle="tab">Anagrafica</a></li>
        {{#if _id}}
          <li class="{{isTabActive 'materialTab'}}"><a class="tab-selector" data-selection="materialTab" data-toggle="tab">Materia e Tecnica</a></li>
          <li class="{{isTabActive 'physicsDescTab'}}"><a class="tab-selector" data-selection="physicsDescTab" data-toggle="tab">Descrizione fisica</a></li>
          <li class="{{isTabActive 'environmentTab'}}"><a class="tab-selector" data-selection="environmentTab" data-toggle="tab">Ambiente e conservazione</a></li>
          <li class="{{isTabActive 'attachmentsTab'}}"><a class="tab-selector" data-selection="attachmentsTab" data-toggle="tab">Allegati</a></li>
          <li class="{{isTabActive 'referentsTab'}}"><a class="tab-selector" data-selection="referentsTab" data-toggle="tab">Referenti</a></li>
          <li class="{{isTabActive 'expositionTab'}}"><a class="tab-selector" data-selection="expositionTab" data-toggle="tab">Esposizione</a></li>
        {{/if}}
      </ul>
      <div class="tabbable tabs-left col-xs-9">
        <div class="tab-content main">
          <div class="tab-pane {{isTabActive 'anagraphicTab'}}" id="anagraphicTab">
            {{> anagraphicSection}}
          </div>
          {{#if _id}}
            <div class="tab-pane {{isTabActive 'materialTab'}}" id="materialTab">
              {{> materialSection}}
            </div>
            <div class="tab-pane {{isTabActive 'physicsDescTab'}}" id="physicsDescTab">
              {{> physicsDescriptionSection}}
            </div>
            <div class="tab-pane {{isTabActive 'environmentTab'}}" id="environmentTab">
              {{> environmentSection}}
            </div>
            <div class="tab-pane {{isTabActive 'attachmentsTab'}}" id="attachmentsTab">
              {{> attachmentsSection}}
            </div>
            <div class="tab-pane {{isTabActive 'referentsTab'}}" id="referentsTab">
              6
            </div>
            <div class="tab-pane {{isTabActive 'expositionTab'}}" id="expositionTab">
              7
            </div>
          {{/if}}
        </div>
        {{#if _id}}
          <button class="prev btn btn-default pull-left {{navigatorHidden 'prev'}}">Prev</button>
          <button class="next btn btn-default pull-right {{navigatorHidden 'next'}}">Next</button>
        {{/if}}
      </div>
    </div>
    <ul class="pager wizard col-xs-9 pull-right">
      {{#if _id}}
        {{> maWizardDelete}}
        {{> maWizardBackToList}}
        {{> maWizardSave}}
      {{else}}
        {{> maWizardCancel}}
        {{> maWizardCreate}}
      {{/if}}
    </ul>
  </div>
</template>

<template name="anagraphicSection">
  <div id="anagraphicSection" class="form-group">
    {{> maWizardTextInput field="inventory" label="Inventory" placeholder="Inventory..."}}
    {{> maWizardTextInput field="title" label="Title" placeholder="Title..."}}
    {{> maWizardTextInput field="authors" label="Author(s)" placeholder="Author(s)..."}}
    {{> maWizardTextarea field="description" label="description" placeholder="Description..."}}
    {{> maWizardTextInput field="dating" label="Dating" placeholder="Ex. 1893, III sec., First half 1900..."}}
    {{> maWizardSelect field="type" label="Artwork type" placeholder="Select artwork type"}}
  </div>
</template>

<template name="materialSection">
  <div id="materialSection">
    {{> maWizardMultiselect field="material" label="Artwork material"}}
    {{> maWizardMultiselect field="technique" label="Artwork technique"}}
    {{> accessoriesSection}}
  </div>
</template>

<template name="accessoriesSection">
  <div id="accessorySection">
    <label>Accessories</label>
    {{#each accessories}}
      {{> maWizardCheckbox field=this label=this}}
    {{/each}}
  </div>
</template>

<template name="physicsDescriptionSection">
  <div id="physicsDescriptionSection">
    <div class="tab-content">
      <div> <!-- objects container -->
        <ul class="nav nav-tabs" role="tablist">
          <li class="active"><a href="#main" role="tab" data-toggle="tab">Main</a></li>
          {{#if isMultiple}}
            {{#each objects}}
              <li><a href="#{{id}}Pane" class="object-tab" role="tab" data-toggle="tab">{{objNum}}</a></li>
            {{/each}}
            <li>
              <a class="add-object" role="tab" data-toggle="tab">
                <span class="glyphicon glyphicon-plus"></span>
              </a>
            </li>
          {{/if}}
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="main">
          <!-- An object passed as a parameter to the template becomes
               the template's data context. Then, current context fields that are needed
               should also be passed as parameters (or we should access them with ../fieldName)
          -->
          {{> dimensionsTemplate

            heightVal = height
            lengthVal = length
            depthVal = depth
            heightField="height" 
            lengthField="length" 
            depthField="depth"

          }}
          </div>
          {{#if isMultiple}}
            {{#each objects}}
            <div class="tab-pane object-pane" id="{{id}}Pane">
              <div class="pane-content">
                <div class="form-group {{maWizardFieldValidity objnameFieldStr }}">
                  <label class="control-label" for="objname">Name {{maWizardErrMsg objnameFieldStr}}</label>
                  <input type="text" class="form-control " data-ma-wizard-control id="objname" placeholder="Object name..." value="{{objname}}"
        data-schemafield={{objnameFieldStr}} maxlength=10>
                </div>
                {{> dimensionsTemplate

                  heightVal = height
                  lengthVal = length
                  depthVal = depth
                  heightField = heightFieldStr 
                  lengthField = lengthFieldStr 
                  depthField = depthFieldStr

                }}
              </div>
              <button class="remove-obj btn btn-danger" data-objref="{{id}}">Remove object</button>
            </div>
            {{/each}}
          {{/if}}
        </div>
      </div>
      <div>
        <label>
          <input class="multiple-checkbox" type="checkbox" value="multiple" {{isChecked}}>
          Opera multipla
        </label>
        {{> unitsSelection}}
      </div>
    </div>
  </div>
</template>

<template name="unitsSelection">
  <div id="unitsSelection">
    <label>Unit:</label>
    <div class="btn-group" data-toggle="buttons">
      <label class="btn btn-primary {{isActive 'cm'}}">
        <input type="radio" data-unit="cm"> cm
      </label>
      <label class="btn btn-primary {{isActive 'in'}}">
        <input type="radio" data-unit="in"> in
      </label>
    </div>
  </div>
</template>

<template name="dimensionsTemplate">
  <div class="dimensionsTemplate">
    <div class="form-group field-height {{maWizardFieldValidity heightField }}">
      <label class="control-label" for="heightElem">Height {{maWizardErrMsg heightField}}</label>
      <input type="text" class="form-control " data-conversion id="heightElem" placeholder="Height in {{unit}}" value="{{convertValue 'heightVal'}}"
        data-schemafield="{{heightField}}" maxlength=10>
    </div>
    <div class="form-group field-length {{maWizardFieldValidity lengthField }}">
      <label class="control-label" for="lengthElem">Length {{maWizardErrMsg lengthField}}</label>
      <input type="text" class="form-control " data-conversion id="lengthElem" placeholder="Length in {{unit}}" value="{{convertValue 'lengthVal'}}" data-schemafield="{{lengthField}}" maxlength=10>
    </div>
    <div class="form-group field-depth {{maWizardFieldValidity depthField }}">
      <label class="control-label" for="depthElem">Depth {{maWizardErrMsg depthField}}</label>
      <input type="text" class="form-control " data-conversion id="depthElem" placeholder="Depth in {{unit}}" value="{{convertValue 'depthVal'}}" data-schemafield="{{depthField}}" maxlength=10>
    </div>
  </div>
</template>

<template name="environmentSection">
  <div id="environmentSection">
    {{> maWizardTextInput field="site" label="Site" placeholder="Site..."}}
    {{> maWizardTextInput field="city" label="City" placeholder="City..."}}
    {{> maWizardCheckbox field="UVP" label="UV protection"}}
    {{> maWizardTextInput field="RH" label="Relative humidity" placeholder="Relative humidity..."}}
    {{> maWizardTextInput field="temperature" label="Temperature" placeholder="Temperature..."}}
    {{> maWizardTextInput field="lux" label="Lux" placeholder="Lux..."}}
    {{> maWizardTextInput field="AMO" label="Adesione Microbica Oraria" placeholder="AMO"}}
  </div>
</template>

<template name="attachmentsSection">
  <div class="col-xs-12" id="attachmentsSection">
    <div class="row form-group">
      <label for="fileinput">Attachments</label>
      <span class="btn btn-default btn-file">
        <i class="fa fa-cloud-upload"></i> Upload image...
        <input id="fileinput" accept="image/*,.pdf" capture="camera" type="file">
      </span>
    </div>    
    {{#each attachments}}
      {{> attachmentSummary}}
    {{/each}}
  </div>
</template>

<template name="attachmentSummary">
  <div id="attachmentSummary" class="col-xs-12 row">
    <div class="col-xs-4">
      {{#if this.isUploaded}}
        {{#if getThumbURL}}
          {{> attachmentThumb}}
        {{else}}
          <div>
            Processing file...
          </div>
        {{/if}}
      {{else}}
        {{> attachmentProgress}}
      {{/if}}
    </div>
    <div class="col-xs-6">
      {{> attachmentInfo}}
    </div>
    <div class="col-xs-2">
      {{> removeAttachment}}
    </div>
  </div>
</template>

<template name="attachmentProgress">
  <div id="attachmentProgress" class="row">
    <div class="row">
      <p class="col-xs-2">
        {{this.uploadProgress}}%
      </p>
      {{> FS.UploadProgressBar bootstrap=true}}
    </div>
    <p class="row">
      Uploading: {{name}}
    </p>
  </div>
</template>

<template name="attachmentThumb">
  <div id="attachmentThumb">
    <img src="{{getThumbURL}}" alt="">
  </div>
</template>

<template name="attachmentInfo">
  <div id="attachmentInfo">
    <p><strong>Filename:</strong> {{name}}</p>
    <p><strong>Type:</strong> {{type}}</p>
    <p><strong>Size:</strong> {{size}} Bytes</p>
    {{> maWizardTextarea field=descFieldStr label="Description" placeholder="Description..."}}
  </div>
</template>

<template name="removeAttachment">
  <button class="remove-atc btn btn-danger" data-atcref="{{_id}}">Remove attachment</button>
</template>