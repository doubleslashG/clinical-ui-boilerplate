<template name="anagraphicArtworkWizard">
  <div id="anagraphicArtworkWizard">
    <div class="col-xs-12">
      <ul class="nav nav-pills nav-stacked col-xs-3">
        <li class="{{isTabActive 'anagraphicTab'}}"><a class="tab-selector" data-selection="anagraphicTab" data-toggle="tab">Anagrafica</a></li>
        {{#if anagraphicSectionIsValid}}
          <li class="{{isTabActive 'materialTab'}}"><a class="tab-selector" data-selection="materialTab" data-toggle="tab">Materia e Tecnica</a></li>
          <li class="{{isTabActive 'physicsDescTab'}}"><a class="tab-selector" data-selection="physicsDescTab" data-toggle="tab">Descrizione fisica</a></li>
          <li class="{{isTabActive 'environmentTab'}}"><a class="tab-selector" data-selection="environmentTab" data-toggle="tab">Ambiente e conservazione</a></li>
          <li class="{{isTabActive 'attachmentsTab'}}"><a class="tab-selector" data-selection="attachmentsTab" data-toggle="tab">Allegati</a></li>
          <li class="{{isTabActive 'referentsTab'}}"><a class="tab-selector" data-selection="referentsTab" data-toggle="tab">Referenti</a></li>
          <li class="{{isTabActive 'expositionTab'}}"><a class="tab-selector" data-selection="expositionTab" data-toggle="tab">Esposizione</a></li>
        {{/if}}
      </ul>
      <div class="tabbable tabs-left col-xs-9">
        <div class="tab-content main">
          <div class="tab-pane {{isTabActive 'anagraphicTab'}}" id="anagraphicTab">
            {{> anagraphicSection}}
          </div>
          <div class="tab-pane {{isTabActive 'materialTab'}}" id="materialTab">
            {{> materialSection}}
          </div>
          <div class="tab-pane {{isTabActive 'physicsDescTab'}}" id="physicsDescTab">
            {{> physicsDescriptionSection}}
          </div>
          <div class="tab-pane {{isTabActive 'environmentTab'}}" id="environmentTab">
            {{> environmentSection}}
          </div>
          <div class="tab-pane {{isTabActive 'attachmentsTab'}}" id="attachmentsTab">
            {{> attachmentsSection}}
          </div>
          <div class="tab-pane {{isTabActive 'referentsTab'}}" id="referentsTab">
            6
          </div>
          <div class="tab-pane {{isTabActive 'expositionTab'}}" id="expositionTab">
            7
          </div>
        </div>
        {{#if anagraphicSectionIsValid}}
          <button class="prev btn btn-default pull-left {{navigatorHidden 'prev'}}">Prev</button>
          <button class="next btn btn-default pull-right {{navigatorHidden 'next'}}">Next</button>
        {{/if}}
      </div>
    </div>
    <ul class="pager wizard col-xs-9 pull-right">
      {{#if anagraphicSectionIsValid}}
      {{> deleteArtwork}}
      {{> backToList}}
      <button class="save btn btn-default">Save</button>
      {{else}}
      <button class="back btn">Cancel</button>
      <button class="create btn btn-default">Create artwork</button>
      {{/if}}
    </ul>
  </div>
</template>

<template name="deleteArtwork">
  <button id="deleteArtwork" class="delete btn btn-danger">Delete artwork</button>
</template>

<template name="backToList">
  <button id="backToList" class="back btn btn-default">Back to list</button>
</template>

<template name="anagraphicSection">
  <div id="anagraphicSection" class="form-group">
    <div class="form-group field-inventory {{fieldValidity 'inventory'}}">
      <label class="control-label" for="inventoryElem">Inventory {{errMsg 'inventory'}}</label>
      <input type="text" class="form-control" id="inventoryElem" placeholder="Inventory" value="{{inventory}}" data-schemafield="inventory" autofocus maxlength=20>
    </div>
    <div class="form-group field-title {{fieldValidity 'title'}}">
      <label class="control-label" for="titleElem">Title {{errMsg 'title'}}</label>
      <input type="text" class="form-control" id="titleElem" placeholder="Title" value="{{title}}" data-schemafield="title" maxlength=200>
    </div>
    <div class="form-group field-authors {{fieldValidity 'authors'}}">
      <label class="control-label" for="authorsElem">Author(s) {{errMsg 'authors'}}</label>
      <input type="text" class="form-control" id="authorsElem" placeholder="Author" value="{{authors}}" data-schemafield="authors" maxlength=20>
    </div>
    <div class="form-group field-description {{fieldValidity 'description'}}">
      <label class="control-label" for="descriptionElem">Description {{errMsg 'description'}}</label>
      <textarea class="form-control" id="descriptionElem" placeholder="Description..." value="{{description}}" data-schemafield="description" maxlength=200></textarea>
    </div>
    <div class="form-group field-dating {{fieldValidity 'dating'}}">
      <label class="control-label" for="datingElem">Dating {{errMsg 'dating'}}</label>
      <input type="text" class="form-control" id="datingElem" placeholder="Ex. 1893, III sec., First half 1900..." value="{{dating}}" data-schemafield="dating" maxlength=20>
    </div>
    <div class="form-group field-type {{fieldValidity 'type'}}">
      <label class="control-label" for="typeElem">Artwork type {{errMsg 'type'}}</label>
      <select id="typeElem" required autocomplete="off" class="form-control" data-schemafield="type">
        <option {{optionIsSelected 'type'}} disabled value="">(Select artwork type)</option>
        {{#each artworkTypes}}
        <option value="{{id}}" {{optionIsSelected "type"}}>{{name}}</option>
        {{/each}}
      </select>
    </div>
  </div>
</template>

<template name="materialSection">
  <div id="materialSection">
    <div class="form-group {{fieldValidity 'material'}}">
      <label class="control-label" for="materialElem">Artwork material {{errMsg 'material'}}</label>
      <select id="materialElem" autocomplete="off" class="form-control" data-schemafield="material" autofocus>
        <option {{optionIsSelected "material"}} disabled value="">(Select artwork material)</option>
        {{#each artworkMaterials}}
        <option {{optionIsSelected "material"}} value="{{id}}">{{name}}</option>
        {{/each}}
      </select>
    </div>
    <div class="form-group {{fieldValidity 'technique'}}">
      <label class="control-label" for="techniqueElem">Artwork technique {{errMsg 'technique'}}</label>
      <select id="techniqueElem" autocomplete="off" class="form-control" data-schemafield="technique">
        <option {{optionIsSelected "technique"}} disabled value="">(Select artwork technique)</option>
        {{#each artworkTechniques}}
        <option {{optionIsSelected "technique"}} value="{{id}}">{{name}}</option>
        {{/each}}
      </select>
    </div>
    {{> accessoriesSection}}
  </div>
</template>

<template name="accessoriesSection">
  <div id="accessorySection">
    <label>Accessories</label>
    {{#each accessories}}
    <div class="checkbox">
      <label>
        <input class="form-checkbox" type="checkbox" {{isChecked  this}} data-schemafield="{{this}}">
        {{this}}
      </label>
    </div>
    {{/each}}
  </div>
</template>

<template name="physicsDescriptionSection">
  <div id="physicsDescriptionSection">
    <div class="tab-content">
      <div> <!-- objects container -->
        <ul class="nav nav-tabs" role="tablist">
          <li class="active"><a href="#main" role="tab" data-toggle="tab">Main</a></li>
          {{#if isMultiple}}
          {{#each objects}}
          <li><a href="#{{id}}Pane" class="object-tab" role="tab" data-toggle="tab">{{objNum}}</a></li>
          {{/each}}
          <li>
            <a class="add-object" role="tab" data-toggle="tab">
              <span class="glyphicon glyphicon-plus"></span>
            </a>
          </li>
          {{/if}}
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="main">
          <!-- An object passed as a parameter to the template becomes
               the template's data context. Then, current context fields that are needed
               should also be passed as parameters (or we should access them with ../fieldName)
          -->
          {{> dimensionsTemplate

            heightVal = height
            lengthVal = length
            depthVal = depth
            heightField="height" 
            lengthField="length" 
            depthField="depth"

          }}
          </div>
          {{#if isMultiple}}
            {{#each objects}}
            <div class="tab-pane object-pane" id="{{id}}Pane">
              <div class="pane-content">
                <div class="form-group {{fieldValidity objnameFieldStr }}">
                  <label class="control-label" for="objname">Name {{errMsg objnameFieldStr}}</label>
                  <input type="text" class="form-control" id="objname" placeholder="Object name..." value="{{objname}}"
        data-schemafield={{objnameFieldStr}} maxlength=10>
                </div>
                {{> dimensionsTemplate

                  heightVal = height
                  lengthVal = length
                  depthVal = depth
                  heightField = heightFieldStr 
                  lengthField = lengthFieldStr 
                  depthField = depthFieldStr

                }}
              </div>
              <button class="remove-obj btn btn-danger" data-objref="{{id}}">Remove object</button>
            </div>
            {{/each}}
          {{/if}}
        </div>
      </div>
      <label>
        <input class="multiple-checkbox" type="checkbox" value="multiple" {{isChecked}}>
        Opera multipla
      </label>
    </div>
  </div>
</template>

<template name="dimensionsTemplate">
  <div class="dimensionsTemplate">
    <div class="form-group field-height {{fieldValidity heightField }}">
      <label class="control-label" for="heightElem">Height {{errMsg heightField}}</label>
      <input type="text" class="form-control" id="heightElem" placeholder="Height in cm" value="{{heightVal}}"
        data-schemafield="{{heightField}}" maxlength=10>
    </div>
    <div class="form-group field-length {{fieldValidity lengthField }}">
      <label class="control-label" for="lengthElem">Length {{errMsg lengthField}}</label>
      <input type="text" class="form-control" id="lengthElem" placeholder="Length in cm" value="{{lengthVal}}" data-schemafield="{{lengthField}}" maxlength=10>
    </div>
    <div class="form-group field-depth {{fieldValidity depthField }}">
      <label class="control-label" for="depthElem">Depth {{errMsg depthField}}</label>
      <input type="text" class="form-control" id="depthElem" placeholder="Depth in cm" value="{{depthVal}}" data-schemafield="{{depthField}}" maxlength=10>
    </div>
  </div>
</template>

<template name="environmentSection">
  <div id="environmentSection">
    <div class="form-group field-site {{fieldValidity 'site'}}">
      <label class="control-label" for="siteElem">Site {{errMsg 'site'}}</label>
      <input type="text" class="form-control" id="siteElem" placeholder="Site" value="{{site}}" data-schemafield="site" maxlength=20>
    </div>
    <div class="form-group field-city {{fieldValidity 'city'}}">
      <label class="control-label" for="cityElem">City {{errMsg 'city'}}</label>
      <input type="text" class="form-control" id="cityElem" placeholder="City" value="{{city}}" data-schemafield="city" maxlength=20>
    </div>
    <div class="checkbox">
      <label>
        <input id="UVPElem" type="checkbox" value="UVP" data-schemafield="UVP" {{isChecked}}>
        UV protection
      </label>
    </div>
    <div class="form-group field-rh {{fieldValidity 'RH'}}">
      <label class="control-label" for="RHElem">Relative humidity {{errMsg 'RH'}}</label>
      <input type="text" class="form-control" id="RHElem" placeholder="Relative humidity" value="{{RH}}" data-schemafield="RH" maxlength=20>
    </div>
    <div class="form-group field-temperature {{fieldValidity 'temperature'}}">
      <label class="control-label" for="temperatureElem">Temperature {{errMsg 'temperature'}}</label>
      <input type="text" class="form-control" id="temperatureElem" placeholder="Temperature" value="{{temperature}}" data-schemafield="temperature" maxlength=20>
    </div>
    <div class="form-group field-lux {{fieldValidity 'lux'}}">
      <label class="control-label" for="luxElem">Lux {{errMsg 'lux'}}</label>
      <input type="text" class="form-control" id="luxElem" placeholder="Lux" value="{{lux}}" data-schemafield="lux" maxlength=20>
    </div>
    <div class="form-group field-amo {{fieldValidity 'AMO'}}">
      <label class="control-label" for="AMOElem">Adesione Microbica Oraria {{errMsg 'AMO'}}</label>
      <input type="text" class="form-control" id="AMOElem" placeholder="AMO" value="{{AMO}}" data-schemafield="AMO" maxlength=20>
    </div>
  </div>
</template>

<template name="attachmentsSection">
  <div class="col-xs-12" id="attachmentsSection">
    <div class="row form-group">
      <label for="fileinput">Attachments</label>
      <span class="btn btn-default btn-file">
        <i class="fa fa-cloud-upload"></i> Upload image...
        <input id="fileinput" accept="image/*,.pdf" capture="camera" type="file">
      </span>
    </div>    
    {{#each attachments}}
      {{> attachmentSummary}}
    {{/each}}
  </div>
</template>

<template name="attachmentSummary">
  <div id="attachmentSummary" class="col-xs-12 row">
    <div class="col-xs-4">
      {{#if this.isUploaded}}
        {{#if getThumbURL}}
          {{> attachmentThumb}}
        {{else}}
          <div>
            Processing file...
          </div>
        {{/if}}
      {{else}}
        {{> attachmentProgress}}
      {{/if}}
    </div>
    <div class="col-xs-6">
      {{> attachmentInfo}}
    </div>
    <div class="col-xs-2">
      {{> removeAttachment}}
    </div>
  </div>
</template>

<template name="attachmentProgress">
  <div id="attachmentProgress" class="row">
    <div class="row">
      <p class="col-xs-2">
        {{this.uploadProgress}}%
      </p>
      {{> FS.UploadProgressBar bootstrap=true}}
    </div>
    <p class="row">
      Uploading: {{name}}
    </p>
  </div>
</template>

<template name="attachmentThumb">
  <div id="attachmentThumb">
    <img src="{{getThumbURL}}" alt="">
  </div>
</template>

<template name="attachmentInfo">
  <div id="attachmentInfo">
    <p><strong>Filename:</strong> {{name}}</p>
    <p><strong>Type:</strong> {{type}}</p>
    <p><strong>Size:</strong> {{size}} Bytes</p>
    <div class="form-group {{fieldValidity descFieldStr}}">
      <label class="control-label" for="atcDesc">Description {{errMsg descFieldStr}}</label>
      <textarea class="form-control" id="atcDesc" placeholder="Description..." value="{{description}}" data-schemafield="{{descFieldStr}}" maxlength=200></textarea>
    </div>
  </div>
</template>

<template name="removeAttachment">
  <button class="remove-atc btn btn-danger" data-atcref="{{_id}}">Remove attachment</button>
</template>